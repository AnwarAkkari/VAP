clc
clear

lb = [...
    0.01 ...
      0.30 7.2 0.38 0.1 0 ... % Lop location, f trans chord, f trans twist, rear trans chord, rear trans twist
      0.30 7.2 0.38 0.10 -3 ... % 
      0.30 7.2 0.38 0.04 -5 ...
    ];

ub = [ ...
    0.7 ...
      0.60 7.49 0.9 0.35 5 ... 
      0.60 7.49 0.9 0.20 5 ...
      0.60 7.50 0.9 0.15 5 ...
    ];


A = [... 
    -1 ... % Tip going outward (inboard)
        0 -1 0 0 0 ...
        0 0 0 0 0 ...
        0 0 0 0 0; ...
        
    0 ... % Tip going outward
        0 1 0 0 0 ...
        0 -1 0 0 0 ...
        0 0 0 0 0; ...
        
    0 ... % Tip going outward
        0 0 0 0 0 ...
        0 1 0 0 0 ...
        0 -1 0 0 0; ...
         
     0 ... % Tip going back 
        1 0 0 0 0 ...
        -1 0 0 0 0 ... 
        0 0 0 0 0; ...
        
     0 ... % Tip going back 
        0 0 0 0 0 ...
        1 0 0 0 0 ... 
        -1 0 0 0 0; ...
       
     0 ... % Tip going up 
        0 0 1 0 0 ...
        0 0 -1 0 0 ...  
        0 0 0 0 0; ...
        
     0 ... % Tip going up 
        0 0 0 0 0 ...
        0 0 1 0 0 ...  
        0 0 -1 0 0; ...
        
     0 ... % taper
        0 0 0 -1 0 ...
        0 0 0 1 0 ...
        0 0 0 0 0; ...
        
     0 ... % taper
        0 0 0 0 0 ...
        0 0 0 -1 0 ...
        0 0 0 1 0; ...    
      ];

b = [...
    -7.55;
    -0.03; 
    -0.03; 
    -0.03;
    -0.03;
    -0.03;
    -0.03;
    -0.03;
    -0.03;
    ];

Aeq = [];
beq = [];

nvars = 16;
TolCon_Data = 1e-6; 
TolFun_Data = 1e-08;

options = gaoptimset;
options = gaoptimset(options,'TolFun', TolFun_Data);
% options = gaoptimset(options,'CrossoverFraction', 0.5);
options = gaoptimset(options,'Display', 'iter');
% options = gaoptimset(options,'InitialPopulation', Seed);
options = gaoptimset(options,'PlotFcns', {  @gaplotbestf @gaplotbestindiv @gaplotexpectation @gaplotscorediversity @gaplotstopping });
options = gaoptimset(options,'Vectorized', 'off');
options = gaoptimset(options,'UseParallel', 1 );
options = gaoptimset(options,'Generations',1000,'StallGenLimit', 50);
[x,fval,exitflag,output,population,score] = gamultiobj(@fcnOBJFUNC,nvars,A,b,Aeq,beq,lb,ub,[],options);