clc
clear

lb = [...
    0.01 0.1 0 0.04 0 ... % Lop location, f trans chord, f trans twist, rear trans chord, rear trans twist
      0.30 6.8 0.38 0.04 -3 ... % 
      0.30 6.8 0.38 0.04 -5 ...
      0.30 6.8 0.1 0.04 -3 ...
      0.30 6.8 0.1 0.04 -5 ...
    ];

ub = [ ...
    0.7 0.2 5 0.3 5 ... 
      0.60 7.49 0.9 0.3 5 ...
      0.60 7.50 0.9 0.3 5 ...
      0.60 7.49 0.9 0.3 5 ...
      0.60 7.50 0.9 0.3 5 ...
    ];


A = [... 
    -1 0 0 0 0 ... % Front tip going outward (inboard)
        0 -1 0 0 0 ...
        0 0 0 0 0 ...
        0 0 0 0 0 ...
        0 0 0 0 0; ...
        
    0 0 0 0 0 ... % Front tip going outward (outboard)
        0 1 0 0 0 ...
        0 -1 0 0 0 ...
        0 0 0 0 0 ...
        0 0 0 0 0; ...        
        
    -1 0 0 0 0 ... % rear tip going outward (inboard)
        0 0 0 0 0 ...
        0 0 0 0 0 ...
        0 -1 0 0 0 ...
        0 0 0 0 0; ...
        
    0 0 0 0 0 ... % rear tip going outward (outboard)
        0 0 0 0 0 ...
        0 0 0 0 0 ...
        0 1 0 0 0 ...
        0 -1 0 0 0; ... 
        
    0 1 0 0 0 ... % rear behind front (inboard)
        1 0 0 0 0 ...
        0 0 0 0 0 ...
        -1 0 0 0 0 ...
        0 0 0 0 0; ...        
  
    0 0 0 0 0 ... % rear behind front (outboard)
        0 0 0 0 0 ...
        1 0 0 1 0 ...
        0 0 0 0 0 ...
        -1 0 0 0 0; ...  
 
    0 0 0 0 0 ... % rear under front (inboard)
        0 0 -1 0 0 ...
        0 0 0 0 0 ...
        0 0 1 0 0 ...
        0 0 0 0 0; ...        
  
    0 0 0 0 0 ... % rear under front (outboard)
        0 0 0 0 0 ...
        0 0 -1 0 0 ...
        0 0 0 0 0 ...
        0 0 1 0 0; ...  
        
    0 1 0 0 0 ... % outboard rear behind inboard front
        1 0 0 0 0 ...
        0 0 0 0 0 ...
        0 0 0 0 0 ...
        -1 0 0 0 0; ...       
 
    0 0 0 0 0 ... % outboard rear under inboard front
        0 0 -1 0 0 ...
        0 0 0 0 0 ...
        0 0 0 0 0 ...
        0 0 1 0 0; ...        
      ];

b = [...
    -7.65; % front tip going outward (inboard)
    -0.03; % front tip going outward (outboard)
    -7.65; % rear tip going outward (inboard)
    -0.03; % rear tip going outward (outboard)
    -0.05; % rear behind front (inboard)
    -0.05; % rear behind front (outboard)
    -0.05; % rear under front (inboard)
    -0.05; % rear under front (outboard)
    -0.05; % outboard rear behind inboard front
    -0.05; % outboard rear under inboard front
    ];

Aeq = [];
beq = [];

nvars = 25;
TolCon_Data = 1e-6; 
TolFun_Data = 1e-08;

Seed = [];
Seed = [...
    0.237684 0.100001 0.461981 0.196315 0.655330 0.300000 7.412857 0.555361 0.106265 -0.175764 0.404558 7.462687 0.784149 0.040076 -0.681382 0.463704 7.412448 0.404258 0.245458 -2.421297 0.494639 7.463002 0.401938 0.149295 -0.146147 ;...
    0.200316 0.100000 0.440505 0.196162 0.613119 0.300000 7.449727 0.432057 0.102842 -0.184042 0.404353 7.499937 0.785225 0.040194 0.859633 0.450009 7.449824 0.382005 0.244799 -2.941006 0.494556 7.500000 0.381995 0.149231 -0.118823 ;...
    0.200000 0.100000 0.403677 0.195910 0.613101 0.300000 7.450000 0.433085 0.103431 -0.176673 0.404652 7.500000 0.786737 0.040000 -1.655463 0.450000 7.450000 0.383085 0.245245 -2.941006 0.494652 7.500000 0.383085 0.149226 -0.079076 ;...
    0.298462 0.100954 0.446872 0.196440 0.613444 0.300000 7.352352 0.508583 0.107075 0.207214 0.404529 7.402911 0.784194 0.040094 -0.652172 0.451497 7.351859 0.420313 0.245483 -2.377743 0.494635 7.402322 0.410572 0.149204 -0.170914 ;...
    0.300548 0.100002 0.435368 0.196620 0.640345 0.300051 7.362058 0.553940 0.107752 -0.089904 0.404567 7.418834 0.787632 0.040081 -0.471407 0.453211 7.355135 0.399189 0.245266 -2.430189 0.494686 7.413838 0.408956 0.148717 -0.146584 ;...
    ];

options = gaoptimset;
options = gaoptimset(options,'TolFun', TolFun_Data);
% options = gaoptimset(options,'CrossoverFraction', 0.5);
options = gaoptimset(options,'Display', 'iter');
options = gaoptimset(options,'InitialPopulation', Seed);
options = gaoptimset(options,'PlotFcns', {  @gaplotbestf @gaplotbestindiv @gaplotexpectation @gaplotscorediversity @gaplotstopping });
options = gaoptimset(options,'Vectorized', 'off');
options = gaoptimset(options,'UseParallel', 1 );
options = gaoptimset(options,'Generations',1000,'StallGenLimit', 50);
[x,fval,exitflag,output,population,score] = gamultiobj(@fcnOBJFUNC2,nvars,A,b,Aeq,beq,lb,ub,[],options);









